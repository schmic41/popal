<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type0" id="S2T0U3">eval_result</span> = eval_bf(<span class="var type1" id="S3T1U6">basis_func</span>,<span class="var type1" id="S4T4U7">xyz</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="mxinfo " id="T2:U3"><span class="var type1" id="S5T2U10">ax</span> = <span class="mxinfo " id="T2:U5"><span class="mxinfo " id="T3:U6"><span class="var type1" id="S3T1U13">basis_func</span>.a</span>(<span class="mxinfo " id="T5:U8">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="mxinfo " id="T2:U9"><span class="var type1" id="S6T2U18">ay</span> = <span class="mxinfo " id="T2:U11"><span class="mxinfo " id="T3:U12"><span class="var type1" id="S3T1U21">basis_func</span>.a</span>(<span class="mxinfo " id="T5:U14">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T2:U15"><span class="var type1" id="S7T2U26">az</span> = <span class="mxinfo " id="T2:U17"><span class="mxinfo " id="T3:U18"><span class="var type1" id="S3T1U29">basis_func</span>.a</span>(<span class="mxinfo " id="T5:U20">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo " id="T6:U21"><span class="var type1" id="S8T6U34">N</span> = <span class="mxinfo " id="T6:U23">repmat(<span class="mxinfo " id="T3:U24"><span class="var type1" id="S3T1U38">basis_func</span>.N</span>,<span class="mxinfo " id="T2:U26">size(<span class="var type1" id="S4T4U42">xyz</span>,1)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T6:U28"><span class="var type1" id="S11T6U47">d</span> = <span class="mxinfo " id="T6:U30">repmat(<span class="mxinfo " id="T3:U31"><span class="var type1" id="S3T1U51">basis_func</span>.d</span>,<span class="mxinfo " id="T2:U33">size(<span class="var type1" id="S4T4U55">xyz</span>,1)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T3:U35"><span class="var type1" id="S12T3U60">alpha</span> = <span class="mxinfo " id="T3:U37"><span class="var type1" id="S3T1U62">basis_func</span>.alpha</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo " id="T6:U39"><span class="var type1" id="S13T6U66">r</span> = <span class="mxinfo " id="T6:U41"><span class="var type1" id="S4T4U68">xyz</span>-<span class="mxinfo " id="T6:U43">repmat(<span class="mxinfo " id="T3:U44"><span class="var type1" id="S3T1U72">basis_func</span>.A</span>,<span class="mxinfo " id="T2:U46">size(<span class="var type1" id="S4T4U76">xyz</span>,1)</span>,1)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T7:U48"><span class="var type1" id="S14T7U81">rA2</span> = <span class="mxinfo " id="T7:U50">sum(<span class="mxinfo " id="T6:U51"><span class="var type1" id="S13T6U85">r</span>.^2</span>,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"><span class="var type0" id="S2T0U90">eval_result</span> = sum(<span class="message error" id="M1F1C"><span class="mxinfo " id="T7:U53"><span class="mxinfo " id="T7:U54"><span class="mxinfo " id="T7:U55">(<span class="mxinfo " id="T7:U56"><span class="var type1" id="S13T6U102">r</span>(<span class="mxinfo " id="T8:U58">:</span>,<span class="mxinfo " id="T5:U59">1</span>)</span>).^<span class="var type1" id="S5T2U105">ax</span></span>.*<span class="mxinfo " id="T7:U61">(<span class="mxinfo " id="T7:U62"><span class="var type1" id="S13T6U109">r</span>(<span class="mxinfo " id="T8:U64">:</span>,<span class="mxinfo " id="T5:U65">2</span>)</span>).^<span class="var type1" id="S6T2U112">ay</span></span></span>.*<span class="mxinfo " id="T7:U67">(<span class="mxinfo " id="T7:U68"><span class="var type1" id="S13T6U116">r</span>(<span class="mxinfo " id="T8:U70">:</span>,<span class="mxinfo " id="T5:U71">3</span>)</span>).^<span class="var type1" id="S7T2U119">az</span></span></span>.*<span class="var type1" id="S8T6U120">N</span></span>.*<span class="var type0" id="S11T0U121">d</span>.*exp(-<span class="var type0" id="S12T0U126">alpha</span> .* <span class="var type0" id="S14T0U127">rA2</span>),2)';</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
</body>
</html>
